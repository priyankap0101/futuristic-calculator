<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ðŸ”¢ Pro Calculator</title>
  <style>
    :root {
      --bg: #0e0e10;
      --text: #f9f9f9;
      --accent: #00f0ff;
    }

    body {
      font-family: "Segoe UI", sans-serif;
      background: var(--bg);
      color: var(--text);
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      margin: 0;
      transition: background 0.4s ease, color 0.4s ease;
    }

    .calculator {
      background: rgba(20, 20, 25, 0.9);
      border-radius: 20px;
      padding: 1.5rem;
      box-shadow: 0 10px 30px rgba(0,0,0,0.6);
      width: 340px;
      backdrop-filter: blur(10px);
    }

    .display {
      background: #1c1c21;
      padding: 1rem;
      border-radius: 12px;
      margin-bottom: 0.4rem;
      font-size: 1.5rem;
      text-align: right;
      box-shadow: inset 0 0 12px rgba(0,0,0,0.5);
      overflow-x: auto;
      white-space: nowrap;
    }

    .preview {
      font-size: 0.9rem;
      text-align: right;
      color: var(--accent);
      min-height: 1.2rem;
      margin-bottom: 1rem;
    }

    .favorites, .buttons {
      display: grid;
      gap: 0.6rem;
      margin-bottom: 1rem;
    }

    .favorites {
      grid-template-columns: repeat(6, 1fr);
    }

    .buttons {
      grid-template-columns: repeat(4, 1fr);
    }

    button {
      background: #1f1f24;
      color: var(--text);
      border: none;
      padding: 1rem;
      font-size: 1.1rem;
      border-radius: 12px;
      box-shadow: 0 3px 8px rgba(0,0,0,0.5);
      transition: all 0.2s ease;
      cursor: pointer;
    }

    button:hover {
      box-shadow: 0 0 10px var(--accent);
      transform: translateY(-2px);
    }

    button:active {
      transform: scale(0.95);
    }

    button.equal {
      background: var(--accent);
      color: #000;
      font-weight: bold;
    }

    .theme-select {
      margin-top: 1rem;
      text-align: center;
    }

    select {
      padding: 0.5rem;
      border-radius: 8px;
      border: none;
      background: #1f1f24;
      color: var(--text);
    }

    /* Error flash */
    .error {
      animation: flash 0.3s ease;
    }
    @keyframes flash {
      0% { background: #ff4c4c; }
      100% { background: #1c1c21; }
    }

    /* === THEMES === */
    .theme-dark { --bg:#0e0e10; --text:#f9f9f9; --accent:#00f0ff; }
    .theme-light { --bg:#f9f9f9; --text:#0e0e10; --accent:#0077ff; }
    .theme-neon { --bg:#000; --text:#39ff14; --accent:#ff00ff; }
    .theme-matrix { --bg:#000; --text:#00ff00; --accent:#00ff88; }
    .theme-aurora { --bg:linear-gradient(135deg,#0f2027,#203a43,#2c5364); --text:#e0f7fa; --accent:#ff9aee; }
    .theme-cyber { --bg:#101018; --text:#f0f0f0; --accent:#ff0077; }
  </style>
</head>
<body>
  <div class="calculator">
    <div class="display" id="display">0</div>
    <div class="preview" id="preview"></div>

    <!-- Favorites Row -->
    <div class="favorites">
      <button title="Square Root" onclick="append('sqrt(')">âˆš</button>
      <button title="Power" onclick="append('^')">^</button>
      <button title="Modulo" onclick="append('%')">%</button>
      <button title="Pi" onclick="append('pi')">Ï€</button>
      <button title="Euler's number" onclick="append('e')">e</button>
      <button title="Logarithm" onclick="append('log(')">log</button>
    </div>

    <!-- Buttons -->
    <div class="buttons">
      <button onclick="clearDisplay()">C</button>
      <button onclick="backspace()">âŒ«</button>
      <button onclick="append('(')">(</button>
      <button onclick="append(')')">)</button>

      <button onclick="append('7')">7</button>
      <button onclick="append('8')">8</button>
      <button onclick="append('9')">9</button>
      <button onclick="append('/')">Ã·</button>

      <button onclick="append('4')">4</button>
      <button onclick="append('5')">5</button>
      <button onclick="append('6')">6</button>
      <button onclick="append('*')">Ã—</button>

      <button onclick="append('1')">1</button>
      <button onclick="append('2')">2</button>
      <button onclick="append('3')">3</button>
      <button onclick="append('-')">âˆ’</button>

      <button onclick="append('0')">0</button>
      <button onclick="append('.')">.</button>
      <button class="equal" onclick="calculate()">=</button>
      <button onclick="append('+')">+</button>
    </div>

    <!-- Theme selector -->
    <div class="theme-select">
      <label>ðŸŽ¨ Theme: </label>
      <select onchange="setTheme(this.value)">
        <option value="dark">Dark</option>
        <option value="light">Light</option>
        <option value="neon">Neon</option>
        <option value="matrix">Matrix</option>
        <option value="aurora">Aurora</option>
        <option value="cyber">Cyber</option>
      </select>
    </div>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/11.8.0/math.js"></script>
  <script>
    const display = document.getElementById("display");
    const preview = document.getElementById("preview");

    function append(value) {
      if (display.innerText === "0" || display.innerText === "Error") display.innerText = "";
      display.innerText += value;
      livePreview();
    }

    function clearDisplay() {
      display.innerText = "0";
      preview.innerText = "";
    }

    function backspace() {
      display.innerText = display.innerText.slice(0, -1) || "0";
      livePreview();
    }

    function calculate() {
      try {
        let expr = display.innerText.replace(/Ï€/g, "pi");
        display.innerText = math.evaluate(expr);
        preview.innerText = "";
      } catch (e) {
        flashError();
      }
    }

    function livePreview() {
      try {
        let expr = display.innerText.replace(/Ï€/g, "pi");
        if (expr.trim() !== "") {
          preview.innerText = "= " + math.evaluate(expr);
        }
      } catch {
        preview.innerText = "";
      }
    }

    function flashError() {
      display.innerText = "Error";
      display.classList.add("error");
      setTimeout(() => display.classList.remove("error"), 300);
    }

    // THEME HANDLING
    function setTheme(theme) {
      document.body.className = "theme-" + theme;
      localStorage.setItem("calc-theme", theme);
    }

    window.addEventListener("DOMContentLoaded", () => {
      const saved = localStorage.getItem("calc-theme") || "dark";
      document.querySelector(".theme-select select").value = saved;
      setTheme(saved);
    });

    // Keyboard support
    document.addEventListener("keydown", e => {
      if ((e.key >= "0" && e.key <= "9") || "+-*/().".includes(e.key)) {
        append(e.key);
      } else if (e.key === "Enter") {
        e.preventDefault();
        calculate();
      } else if (e.key === "Backspace") {
        backspace();
      } else if (e.key.toLowerCase() === "c") {
        clearDisplay();
      }
    });
  </script>
</body>
</html>

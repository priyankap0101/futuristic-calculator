<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>ðŸ”¢ Pro Calculator</title>
  <style>
    :root {
      --bg: #0e0e10;
      --text: #f9f9f9;
      --accent: #00f0ff;
      --danger: #ff3b3b;
    }
    body {
      margin: 0;
      font-family: "Orbitron", sans-serif;
      background: var(--bg);
      color: var(--text);
      display: flex;
      height: 100vh;
      align-items: center;
      justify-content: center;
    }
    .calculator {
      width: 380px;
      background: rgba(20, 20, 30, 0.8);
      border-radius: 20px;
      box-shadow: 0 8px 25px rgba(0,0,0,0.6);
      padding: 1.5rem;
      display: flex;
      flex-direction: column;
      backdrop-filter: blur(12px);
    }
    .display {
      width: 100%;
      height: 60px;
      font-size: 1.6rem;
      text-align: right;
      border: none;
      outline: none;
      margin-bottom: 1rem;
      padding: 0.5rem 0.8rem;
      border-radius: 12px;
      background: rgba(255,255,255,0.05);
      color: var(--text);
      box-shadow: inset 0 3px 6px rgba(0,0,0,0.4);
    }
    .row, .favorites-row, .memory-row {
      display: grid;
      grid-template-columns: repeat(4, 1fr);
      gap: 0.6rem;
      margin-bottom: 0.6rem;
    }
    button {
      padding: 0.8rem;
      font-size: 1.1rem;
      border: none;
      border-radius: 12px;
      background: #2a2a33;
      color: var(--text);
      cursor: pointer;
      transition: all 0.2s ease;
      box-shadow: 0 3px 8px rgba(0,0,0,0.6);
    }
    button:hover {
      background: var(--accent);
      color: #000;
      transform: translateY(-2px);
      box-shadow: 0 6px 12px var(--accent);
    }
    .danger {
      background: var(--danger);
      color: #fff;
    }
    .theme-select {
      margin-top: 0.5rem;
      padding: 0.4rem;
      border-radius: 8px;
      border: none;
      background: #2a2a33;
      color: var(--text);
      font-size: 0.9rem;
    }
    .history-panel {
      position: fixed;
      right: -260px;
      top: 0;
      width: 250px;
      height: 100vh;
      background: rgba(20,20,30,0.95);
      box-shadow: -4px 0 12px rgba(0,0,0,0.5);
      padding: 1rem;
      overflow-y: auto;
      transition: right 0.3s ease;
    }
    .history-panel.open {
      right: 0;
    }
    .history-panel h3 {
      margin-top: 0;
      margin-bottom: 0.8rem;
      color: var(--accent);
    }
    .history-item {
      margin: 0.4rem 0;
      padding: 0.3rem;
      border-radius: 6px;
      background: rgba(255,255,255,0.05);
      cursor: pointer;
    }
    /* Aurora Theme Glassmorphism */
    body.aurora {
      background: linear-gradient(135deg, rgba(0,255,200,0.3), rgba(0,150,255,0.3), rgba(255,0,200,0.2));
      backdrop-filter: blur(18px);
    }
  </style>
</head>
<body>
  <div class="calculator">
    <input id="display" class="display" readonly />

    <!-- Favorites -->
    <div class="favorites-row">
      <button onclick="insert('âˆš(')">âˆš</button>
      <button onclick="insert('^')">^</button>
      <button onclick="insert('%')">%</button>
      <button onclick="insert('Ï€')">Ï€</button>
      <button onclick="insert('e')">e</button>
      <button onclick="insert('log(')">log</button>
    </div>

    <!-- Memory -->
    <div class="memory-row">
      <button onclick="memoryClear()">MC</button>
      <button onclick="memoryRecall()">MR</button>
      <button onclick="memoryAdd()">M+</button>
      <button onclick="memorySubtract()">M-</button>
    </div>

    <!-- Trigonometry -->
    <div class="row">
      <button onclick="insert('sin(')">sin</button>
      <button onclick="insert('cos(')">cos</button>
      <button onclick="insert('tan(')">tan</button>
      <button onclick="insert('ln(')">ln</button>
    </div>

    <!-- Digits & Ops -->
    <div class="row">
      <button onclick="insert('7')">7</button>
      <button onclick="insert('8')">8</button>
      <button onclick="insert('9')">9</button>
      <button onclick="insert('/')">Ã·</button>
    </div>
    <div class="row">
      <button onclick="insert('4')">4</button>
      <button onclick="insert('5')">5</button>
      <button onclick="insert('6')">6</button>
      <button onclick="insert('*')">Ã—</button>
    </div>
    <div class="row">
      <button onclick="insert('1')">1</button>
      <button onclick="insert('2')">2</button>
      <button onclick="insert('3')">3</button>
      <button onclick="insert('-')">âˆ’</button>
    </div>
    <div class="row">
      <button onclick="insert('0')">0</button>
      <button onclick="insert('.')">.</button>
      <button onclick="insert('+')">+</button>
      <button onclick="calculate()">=</button>
    </div>
    <div class="row">
      <button onclick="insert('(')">(</button>
      <button onclick="insert(')')">)</button>
      <button class="danger" onclick="clearDisplay()">C</button>
      <button onclick="toggleHistory()">ðŸ“œ</button>
    </div>

    <select id="theme" class="theme-select" onchange="setTheme(this.value)">
      <option value="dark">Dark</option>
      <option value="light">Light</option>
      <option value="neon">Neon</option>
      <option value="matrix">Matrix</option>
      <option value="aurora">Aurora</option>
      <option value="cyber">Cyber</option>
    </select>
    <label style="margin-top:0.5rem;">
      <input type="checkbox" id="degRad" checked> Degrees
    </label>
  </div>

  <div class="history-panel" id="history">
    <h3>History</h3>
    <button onclick="clearHistory()" class="danger">Clear History</button>
    <div id="historyList"></div>
  </div>

<script>
  const display = document.getElementById("display");
  const historyPanel = document.getElementById("history");
  const historyList = document.getElementById("historyList");
  const degRad = document.getElementById("degRad");

  let memory = 0;
  let historyData = [];

  function insert(val) {
    if(val === 'Ï€') val = Math.PI;
    if(val === 'e') val = Math.E;
    display.value += val;
  }
  function clearDisplay() {
    display.value = "";
  }
  function calculate() {
    try {
      let expr = display.value.replace(/âˆš/g,"Math.sqrt")
                              .replace(/Ï€/g,"Math.PI")
                              .replace(/e/g,"Math.E")
                              .replace(/log/g,"Math.log10")
                              .replace(/ln/g,"Math.log");
      if(degRad.checked) {
        expr = expr.replace(/sin\((.*?)\)/g,"Math.sin(($1)*Math.PI/180)")
                   .replace(/cos\((.*?)\)/g,"Math.cos(($1)*Math.PI/180)")
                   .replace(/tan\((.*?)\)/g,"Math.tan(($1)*Math.PI/180)");
      } else {
        expr = expr.replace(/sin/g,"Math.sin")
                   .replace(/cos/g,"Math.cos")
                   .replace(/tan/g,"Math.tan");
      }
      expr = expr.replace(/(\d+)\^(\d+)/g,"Math.pow($1,$2)");
      let result = eval(expr);
      historyData.push(display.value + " = " + result);
      localStorage.setItem("calc-history", JSON.stringify(historyData));
      updateHistory();
      display.value = result;
    } catch(e) {
      display.value = "Error";
    }
  }

  // Memory functions
  function memoryClear(){ memory=0; localStorage.removeItem("calc-memory"); }
  function memoryRecall(){ display.value += memory; }
  function memoryAdd(){ memory += eval(display.value||0); localStorage.setItem("calc-memory", memory); }
  function memorySubtract(){ memory -= eval(display.value||0); localStorage.setItem("calc-memory", memory); }

  // History panel
  function toggleHistory(){ historyPanel.classList.toggle("open"); }
  function updateHistory(){
    historyList.innerHTML = "";
    historyData.forEach((h, i) => {
      const item = document.createElement("div");
      item.className = "history-item";
      item.textContent = h;
      item.onclick = () => { display.value = h.split("=")[1].trim(); };
      historyList.appendChild(item);
    });
  }
  function clearHistory(){ historyData=[]; localStorage.removeItem("calc-history"); updateHistory(); }

  // Themes
  function setTheme(t) {
    document.body.className = t;
    localStorage.setItem("calc-theme", t);
  }
  window.addEventListener("DOMContentLoaded", () => {
    if(localStorage.getItem("calc-theme")) {
      setTheme(localStorage.getItem("calc-theme"));
      document.getElementById("theme").value = localStorage.getItem("calc-theme");
    }
    if(localStorage.getItem("calc-memory")) {
      memory = parseFloat(localStorage.getItem("calc-memory"));
    }
    if(localStorage.getItem("calc-history")) {
      historyData = JSON.parse(localStorage.getItem("calc-history"));
      updateHistory();
    }
  });

  // Keyboard support (including history navigation)
  let historyIndex = -1;
  document.addEventListener("keydown", e => {
    if(e.key==="Enter") calculate();
    if(e.key==="Backspace") display.value = display.value.slice(0,-1);
    if(e.key==="ArrowUp") {
      if(historyData.length>0) {
        historyIndex = (historyIndex<=0)? historyData.length-1 : historyIndex-1;
        display.value = historyData[historyIndex].split("=")[0].trim();
      }
    }
    if(e.key==="ArrowDown") {
      if(historyData.length>0) {
        historyIndex = (historyIndex>=historyData.length-1)?0:historyIndex+1;
        display.value = historyData[historyIndex].split("=")[0].trim();
      }
    }
  });
</script>
</body>
</html>
